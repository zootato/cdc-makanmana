"use strict";(self.webpackChunkcdc_makanmana=self.webpackChunkcdc_makanmana||[]).push([[248],{248:(t,e,s)=>{s.d(e,{HalalService:()=>a});class a{static async initialize(){if(!this.initialized)try{const t=await fetch("https://raw.githubusercontent.com/zootato/singapore-halal-establishments/main/halal_establishments.json");if(!t.ok)throw new Error("GitHub API returned ".concat(t.status));this.halalEstablishments=await t.json(),this.initialized=!0,console.log("Loaded ".concat(this.halalEstablishments.length," halal establishments from GitHub"))}catch(t){console.error("Failed to load halal establishments from GitHub:",t),this.halalEstablishments=[],this.initialized=!0}}static async isHalal(t){await this.initialize();const e=this.findBestNameMatch(t.name,t.postalCode);return e?{isHalal:!0,source:e.source,certNumber:e.establishment.number}:{isHalal:!1,source:"NOT_IN_OFFICIAL_RECORDS"}}static findBestNameMatch(t,e){const s=this.cleanName(t),a=this.halalEstablishments.find(t=>this.cleanName(t.name)===s);if(a)return a.postal===e?{establishment:a,source:"MUIS_VERIFIED_EXACT_POSTAL"}:{establishment:a,source:"MUIS_VERIFIED_EXACT_NAME"};const l=s.split(" ").filter(t=>t.length>2);let i=null;for(const n of this.halalEstablishments){const t=this.cleanName(n.name).split(" ").filter(t=>t.length>2),s=l.filter(e=>t.some(t=>t.includes(e)||e.includes(t)||this.isWordSimilar(e,t))),a=s.length/Math.max(l.length,t.length),h=n.postal===e;a>=.5&&s.length>=Math.min(2,l.length)&&(!i||h&&!i.hasPostal||h===i.hasPostal&&a>i.similarity)&&(i={establishment:n,similarity:a,hasPostal:h})}return i?i.hasPostal?{establishment:i.establishment,source:"MUIS_VERIFIED_SIMILAR_POSTAL"}:{establishment:i.establishment,source:"MUIS_VERIFIED_SIMILAR_NAME"}:null}static isWordSimilar(t,e){const s={restaurant:["rest","resto"],kitchen:["kitchn","kitch"],food:["fd"],house:["hse"],corner:["cnr"],centre:["center","ctr"],international:["intl"],company:["co"],private:["pte","pvt"],limited:["ltd"]};for(const[n,h]of Object.entries(s))if(t===n&&h.includes(e)||e===n&&h.includes(t)||h.includes(t)&&h.includes(e))return!0;const a=t.length>e.length?t:e,l=t.length>e.length?e:t;if(0===a.length)return!1;const i=this.levenshteinDistance(a,l);return(a.length-i)/a.length>=.8}static levenshteinDistance(t,e){const s=Array(e.length+1).fill(null).map(()=>Array(t.length+1).fill(null));for(let a=0;a<=t.length;a++)s[0][a]=a;for(let a=0;a<=e.length;a++)s[a][0]=a;for(let a=1;a<=e.length;a++)for(let l=1;l<=t.length;l++){const i=t[l-1]===e[a-1]?0:1;s[a][l]=Math.min(s[a][l-1]+1,s[a-1][l]+1,s[a-1][l-1]+i)}return s[e.length][t.length]}static cleanName(t){return t.toLowerCase().replace(/\b(pte|ltd|private|limited|sdn|bhd)\b/g,"").replace(/\b(stall|#|unit|\d+[a-z]?)\s*\d+/g,"").replace(/[^\w\s]/g," ").replace(/\s+/g," ").trim()}}a.halalEstablishments=[],a.initialized=!1}}]);
//# sourceMappingURL=248.e6ee8592.chunk.js.map