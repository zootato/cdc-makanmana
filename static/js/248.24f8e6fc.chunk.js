"use strict";(self.webpackChunkcdc_makanmana=self.webpackChunkcdc_makanmana||[]).push([[248],{248:(t,e,a)=>{a.d(e,{HalalService:()=>s});class s{static async initialize(){if(!this.initialized)try{const t=await fetch("https://raw.githubusercontent.com/zootato/singapore-halal-establishments/main/halal_establishments.json");if(!t.ok)throw new Error("GitHub API returned ".concat(t.status));this.halalEstablishments=await t.json(),this.initialized=!0,console.log("Loaded ".concat(this.halalEstablishments.length," halal establishments from GitHub"))}catch(t){console.error("Failed to load halal establishments from GitHub:",t),this.halalEstablishments=[],this.initialized=!0}}static async isHalal(t){await this.initialize();const e=this.findBestNameMatch(t.name,t.postalCode);return e?{isHalal:!0,source:e.source,certNumber:e.establishment.number}:{isHalal:!1,source:"NOT_IN_OFFICIAL_RECORDS"}}static findBestNameMatch(t,e){const a=this.cleanName(t),s=this.halalEstablishments.find(t=>this.cleanName(t.name)===a);if(s)return s.postal===e?{establishment:s,source:"MUIS_VERIFIED_EXACT_POSTAL"}:{establishment:s,source:"MUIS_VERIFIED_EXACT_NAME"};const l=a.split(" ").filter(t=>t.length>2);let n=null;for(const i of this.halalEstablishments){const a=this.cleanName(i.name).split(" ").filter(t=>t.length>2),s=l.filter(t=>a.some(e=>e.includes(t)||t.includes(e)||this.isWordSimilar(t,e))),h=s.length/Math.max(l.length,a.length),c=i.postal===e;h>=.8&&s.length>=2&&l.length>=2&&(console.log('Potential halal match found:\n          Merchant: "'.concat(t,'"\n          MUIS: "').concat(i.name,'"\n          Similarity: ').concat(h.toFixed(2),"\n          Matching words: ").concat(s.join(", "),"\n          Postal match: ").concat(c)),(!n||c&&!n.hasPostal||c===n.hasPostal&&h>n.similarity)&&(n={establishment:i,similarity:h,hasPostal:c}))}return n?n.hasPostal?{establishment:n.establishment,source:"MUIS_VERIFIED_SIMILAR_POSTAL"}:{establishment:n.establishment,source:"MUIS_VERIFIED_SIMILAR_NAME"}:null}static isWordSimilar(t,e){const a={restaurant:["rest","resto"],kitchen:["kitchn","kitch"],food:["fd"],house:["hse"],corner:["cnr"],centre:["center","ctr"],international:["intl"],company:["co"],private:["pte","pvt"],limited:["ltd"]};for(const[i,h]of Object.entries(a))if(t===i&&h.includes(e)||e===i&&h.includes(t)||h.includes(t)&&h.includes(e))return!0;const s=t.length>e.length?t:e,l=t.length>e.length?e:t;if(0===s.length)return!1;const n=this.levenshteinDistance(s,l);return(s.length-n)/s.length>=.8}static levenshteinDistance(t,e){const a=Array(e.length+1).fill(null).map(()=>Array(t.length+1).fill(null));for(let s=0;s<=t.length;s++)a[0][s]=s;for(let s=0;s<=e.length;s++)a[s][0]=s;for(let s=1;s<=e.length;s++)for(let l=1;l<=t.length;l++){const n=t[l-1]===e[s-1]?0:1;a[s][l]=Math.min(a[s][l-1]+1,a[s-1][l]+1,a[s-1][l-1]+n)}return a[e.length][t.length]}static cleanName(t){return t.toLowerCase().replace(/\b(pte|ltd|private|limited|sdn|bhd)\b/g,"").replace(/\b(stall|#|unit|\d+[a-z]?)\s*\d+/g,"").replace(/[^\w\s]/g," ").replace(/\s+/g," ").trim()}}s.halalEstablishments=[],s.initialized=!1}}]);
//# sourceMappingURL=248.24f8e6fc.chunk.js.map